# 腾讯云账号配置手册

**任务ID**: 1.1.3
**负责人**: 基础设施团队
**预计耗时**: 2小时
**截止日期**: 2026-01-03

---

## 一、准备工作

### 1.1 前置条件

- 拥有腾讯云企业账号（或个人账号）
- 拥有Root账户访问权限
- 已安装腾讯云CLI（可选）
- 已配置手机或认证器（MFA）

### 1.2 需要的信息

| 信息项 | 示例值 | 说明 |
|-------|-------|------|
| 腾讯云账号ID (AppID) | `1234567890` | 数字 |
| 显示名 | `YYC³餐饮平台` | 控制台显示名称 |
| 地域 | `ap-guangzhou` | 主要部署地域 |

---

## 二、配置步骤

### 2.1 创建企业账号（如不存在）

**步骤**：
1. 访问 [腾讯云控制台](https://console.cloud.tencent.com)
2. 使用Root账户登录（邮箱/手机号+密码）
3. 登录后，查看右上角显示的账号ID（AppID）

**检查清单**：
- [ ] 腾讯云账号已创建
- [ ] 可以成功登录

---

### 2.2 配置账号显示名

**步骤**：
1. 在控制台右上角，点击账号头像
2. 点击 "账号信息"
3. 找到 "账号昵称" 部分
4. 点击 "修改"
5. 输入账号昵称：`YYC³餐饮平台`
6. 点击 "确定"

**检查清单**：
- [ ] 账号昵称已配置
- [ ] 控制台右上角显示 "YYC³餐饮平台"

---

### 2.3 启用Root账户MFA（多因素认证）

**步骤**：
1. 在控制台右上角，点击账号头像
2. 点击 "安全信息"
3. 找到 "MFA设备" 部分
4. 点击 "绑定"
5. 下载并安装MFA应用（如腾讯云MFA、Google Authenticator）
6. 扫描二维码或手动输入密钥
7. 输入MFA应用生成的6位验证码
8. 点击 "确定"

**检查清单**：
- [ ] Root账户MFA已启用
- [ ] 下次登录需要输入MFA验证码

---

### 2.4 创建CAM管理员账户

**步骤**：
1. 在控制台右上角，搜索 "CAM"
2. 点击 "访问管理 (CAM)"
3. 在左侧导航栏，点击 "用户列表"
4. 点击 "新建用户"
5. 输入用户名：`yyc3-admin`
6. 访问方式：
   - 勾选 "编程访问"（SecretId/SecretKey）
   - 勾选 "腾讯云控制台访问"（密码登录）
7. 设置登录密码
8. 点击 "下一步"
9. 选择权限类型："用户组" 或 "直接策略"
10. 搜索并添加策略：`QcloudAccessForAllResources`（AdministratorAccess）
11. 点击 "完成"
12. 复制并保存 "SecretId" 和 "SecretKey"

**重要提示**：
- SecretKey仅在创建时显示一次，请妥善保存
- 建议将SecretKey保存到密码管理工具（如1Password）

**检查清单**：
- [ ] CAM管理员账户已创建
- [ ] 已保存SecretId和SecretKey

---

### 2.5 配置腾讯云CLI（可选）

**步骤**：
1. 安装腾讯云CLI：
   ```bash
   # macOS
   brew install tccli

   # Linux
   wget https://sdk-1300250971.cos.ap-guangzhou.myqcloud.com/tccli-linux-3.0.1102.tar.gz
   tar xzvf tccli-linux-3.0.1102.tar.gz
   sudo mv tccli /usr/local/bin/
   ```

2. 配置腾讯云CLI：
   ```bash
   tccli configure
   ```

3. 输入以下信息：
   - SecretId: （从CAM管理员账户复制）
   - SecretKey: （从CAM管理员账户复制）
   - Region: `ap-guangzhou`
   - Output Format: `json`

4. 验证配置：
   ```bash
   tccli cam GetCallerIdentity
   ```

**检查清单**：
- [ ] 腾讯云CLI已安装
- [ ] 腾讯云CLI已配置
- [ ] 验证命令返回正确的账号ID

---

### 2.6 创建自定义CAM策略（可选）

**目的**：为项目创建专用的管理策略，而不是直接使用`QcloudAccessForAllResources`。

**步骤**：
1. 在CAM控制台，点击 "策略列表"
2. 点击 "新建自定义策略"
3. 选择创建方式："按策略语法创建"
4. 输入策略名称：`yyc3-full-access`
5. 输入备注：`YYC³餐饮平台 - 全局访问权限`
6. 选择模板："空白模板"
7. 输入策略内容：
   ```json
   {
     "version": "2.0",
     "statement": [
       {
         "effect": "allow",
         "action": "*",
         "resource": "*"
       }
     ]
   }
   ```
8. 点击 "创建策略"

**检查清单**：
- [ ] 自定义CAM策略已创建
- [ ] 策略名称：`yyc3-full-access`

---

### 2.7 创建CAM用户组

**目的**：创建用户组，将多个用户分配到同一权限组。

**步骤**：
1. 在CAM控制台，点击 "用户组"
2. 点击 "新建用户组"
3. 输入用户组名称：`yyc3-admins`
4. 输入备注：`YYC³餐饮平台 - 管理员组`
5. 点击 "确定"

**检查清单**：
- [ ] CAM用户组已创建

---

### 2.8 将CAM管理员账户添加到用户组

**步骤**：
1. 在CAM控制台，点击 "用户组"
2. 找到用户组 `yyc3-admins`，点击用户组名称
3. 点击 "添加成员"
4. 搜索并勾选用户 `yyc3-admin`
5. 点击 "确定"

**检查清单**：
- [ ] CAM管理员账户已添加到用户组

---

### 2.9 添加权限到用户组

**步骤**：
1. 在CAM控制台，点击 "用户组"
2. 找到用户组 `yyc3-admins`，点击用户组名称
3. 点击 "权限管理" -> "关联策略"
4. 搜索并添加策略：`yyc3-full-access`（或 `QcloudAccessForAllResources`）
5. 点击 "确定"

**检查清单**：
- [ ] 策略已添加到用户组

---

## 三、验证与测试

### 3.1 验证账号配置

**命令**：
```bash
tccli cam GetCallerIdentity
```

**预期输出**：
```json
{
  "UserUin": "1234567890",
  "UserId": "1234567890",
  "PrincipalId": "1234567890",
  "Type": "User",
  "AccountUin": "1234567890",
  "Arn": "qcs::cam::uin/1234567890:user/yyc3-admin"
}
```

### 3.2 验证CAM权限

**命令**：
```bash
tccli cam ListPolicies
```

**预期输出**：
- 返回策略列表，包括 `yyc3-full-access`

### 3.3 验证用户组

**命令**：
```bash
tccli cam ListGroupsForUser --Name yyc3-admin
```

**预期输出**：
```json
{
  "GroupInfo": [
    {
      "GroupId": 123,
      "GroupName": "yyc3-admins",
      "Remark": "YYC³餐饮平台 - 管理员组",
      "CreateTime": "2026-01-03T00:00:00Z"
    }
  ]
}
```

---

## 四、常见问题

### Q1: 忘记了Root账户密码怎么办？

**A**：
1. 访问 https://console.cloud.tencent.com/forgot_password
2. 输入账号邮箱或手机号
3. 按照提示重置密码

---

### Q2: SecretKey丢失了怎么办？

**A**：
1. 以管理员身份登录CAM控制台
2. 找到对应用户
3. 点击 "API密钥"
4. 点击 "新建密钥"
5. 创建新的SecretKey
6. 删除旧的SecretKey（如有必要）

---

### Q3: 如何限制管理员权限？

**A**：
1. 创建自定义策略，只授予必要的权限
2. 使用最小权限原则（Least Privilege）
3. 定期审计CAM权限

---

## 五、输出与交付物

| 交付物 | 内容 |
|-------|------|
| 腾讯云账号ID (AppID) | `1234567890` |
| 账号昵称 | `YYC³餐饮平台` |
| CAM管理员账户 | `yyc3-admin` |
| CAM SecretId | `AKID...`（保存到密码管理工具） |
| CAM SecretKey | `...`（保存到密码管理工具） |
| CAM用户组 | `yyc3-admins` |
| CAM策略 | `yyc3-full-access` |

---

## 六、参考文档

- [腾讯云CAM文档](https://cloud.tencent.com/document/product/598)
- [腾讯云CLI文档](https://cloud.tencent.com/document/product/440)
- [腾讯云Root账户最佳实践](https://cloud.tencent.com/document/product/598/13583)

---

**文档版本**: v1.0.0
**最后更新**: 2026-01-03
**维护人**: YYC³ Infrastructure Team
