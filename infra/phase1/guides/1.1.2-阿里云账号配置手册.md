# 阿里云账号配置手册

**任务ID**: 1.1.2
**负责人**: 基础设施团队
**预计耗时**: 3小时
**截止日期**: 2026-01-03

---

## 一、准备工作

### 1.1 前置条件

- 拥有阿里云企业账号（或个人账号）
- 拥有Root账户访问权限
- 已安装阿里云CLI（可选）
- 已配置手机或认证器（MFA）

### 1.2 需要的信息

| 信息项 | 示例值 | 说明 |
|-------|-------|------|
| 阿里云账号ID | `1234567890123456` | 16位数字 |
| 显示名 | `YYC³餐饮平台` | 控制台显示名称 |
| 地域 | `cn-hangzhou` | 主要部署地域 |

---

## 二、配置步骤

### 2.1 创建企业账号（如不存在）

**步骤**：
1. 访问 [阿里云控制台](https://console.aliyun.com)
2. 使用Root账户登录（邮箱/手机号+密码）
3. 登录后，查看右上角显示的账号ID

**检查清单**：
- [ ] 阿里云账号已创建
- [ ] 可以成功登录

---

### 2.2 配置账号显示名

**步骤**：
1. 在控制台右上角，点击账号头像
2. 点击 "账号信息"
3. 找到 "账号显示名" 部分
4. 点击 "修改"
5. 输入账号显示名：`YYC³餐饮平台`
6. 点击 "确定"

**检查清单**：
- [ ] 账号显示名已配置
- [ ] 控制台右上角显示 "YYC³餐饮平台"

---

### 2.3 启用Root账户MFA（多因素认证）

**步骤**：
1. 在控制台右上角，点击账号头像
2. 点击 "安全信息管理"
3. 找到 "虚拟MFA设备" 部分
4. 点击 "绑定"
5. 下载并安装MFA应用（如Google Authenticator、Microsoft Authenticator）
6. 扫描二维码或手动输入密钥
7. 输入MFA应用生成的6位验证码
8. 点击 "确定"

**检查清单**：
- [ ] Root账户MFA已启用
- [ ] 下次登录需要输入MFA验证码

---

### 2.4 创建RAM管理员账户

**步骤**：
1. 在控制台右上角，搜索 "RAM"
2. 点击 "RAM 访问控制"
3. 在左侧导航栏，点击 "人员管理" -> "用户"
4. 点击 "创建用户"
5. 输入用户名：`yyc3-admin`
6. 选择访问方式：
   - 勾选 "编程访问"（AccessKey）
   - 勾选 "控制台访问"（密码登录）
7. 设置登录密码
8. 点击 "确定"
9. 复制并保存 "AccessKey ID" 和 "AccessKey Secret"

**重要提示**：
- AccessKey Secret仅在创建时显示一次，请妥善保存
- 建议将AccessKey Secret保存到密码管理工具（如1Password）

**检查清单**：
- [ ] RAM管理员账户已创建
- [ ] 已保存AccessKey ID和AccessKey Secret

---

### 2.5 添加RAM权限

**步骤**：
1. 在RAM控制台，点击 "人员管理" -> "用户"
2. 找到用户 `yyc3-admin`，点击用户名
3. 点击 "添加权限"
4. 选择权限类型：`系统策略`
5. 搜索并添加策略：`AdministratorAccess`
6. 点击 "确定"

**检查清单**：
- [ ] 已添加 `AdministratorAccess` 权限

---

### 2.6 配置阿里云CLI（可选）

**步骤**：
1. 安装阿里云CLI：
   ```bash
   # macOS
   brew install aliyun-cli

   # Linux
   wget https://aliyuncli.alicdn.com/aliyun-cli-linux-latest-amd64.tgz
   tar xzvf aliyun-cli-linux-latest-amd64.tgz
   sudo mv aliyun /usr/local/bin/
   ```

2. 配置阿里云CLI：
   ```bash
   aliyun configure
   ```

3. 输入以下信息：
   - Access Key ID: （从RAM管理员账户复制）
   - Access Key Secret: （从RAM管理员账户复制）
   - Default Region Id: `cn-hangzhou`
   - Default Output Format: `json`

4. 验证配置：
   ```bash
   aliyun sts GetCallerIdentity
   ```

**检查清单**：
- [ ] 阿里云CLI已安装
- [ ] 阿里云CLI已配置
- [ ] 验证命令返回正确的账号ID

---

### 2.7 创建自定义RAM策略（可选）

**目的**：为项目创建专用的管理策略，而不是直接使用`AdministratorAccess`。

**步骤**：
1. 在RAM控制台，点击 "权限管理" -> "权限策略"
2. 点击 "创建权限策略"
3. 选择配置模式：`脚本配置`
4. 输入策略名称：`yyc3-full-access`
5. 输入备注：`YYC³餐饮平台 - 全局访问权限`
6. 输入策略内容：
   ```json
   {
     "Version": "1",
     "Statement": [
       {
         "Effect": "Allow",
         "Action": "*",
         "Resource": "*"
       }
     ]
   }
   ```
7. 点击 "确定"

**检查清单**：
- [ ] 自定义RAM策略已创建
- [ ] 策略名称：`yyc3-full-access`

---

### 2.8 创建RAM用户组

**目的**：创建用户组，将多个用户分配到同一权限组。

**步骤**：
1. 在RAM控制台，点击 "人员管理" -> "用户组"
2. 点击 "创建用户组"
3. 输入用户组名称：`yyc3-admins`
4. 输入备注：`YYC³餐饮平台 - 管理员组`
5. 点击 "确定"

**检查清单**：
- [ ] RAM用户组已创建

---

### 2.9 将RAM管理员账户添加到用户组

**步骤**：
1. 在RAM控制台，点击 "人员管理" -> "用户组"
2. 找到用户组 `yyc3-admins`，点击用户组名称
3. 点击 "添加组成员"
4. 搜索并勾选用户 `yyc3-admin`
5. 点击 "确定"

**检查清单**：
- [ ] RAM管理员账户已添加到用户组

---

### 2.10 添加权限到用户组

**步骤**：
1. 在RAM控制台，点击 "人员管理" -> "用户组"
2. 找到用户组 `yyc3-admins`，点击用户组名称
3. 点击 "添加权限"
4. 选择权限类型：`系统策略`
5. 搜索并添加策略：`yyc3-full-access`（或 `AdministratorAccess`）
6. 点击 "确定"

**检查清单**：
- [ ] 策略已添加到用户组

---

## 三、验证与测试

### 3.1 验证账号配置

**命令**：
```bash
aliyun sts GetCallerIdentity
```

**预期输出**：
```json
{
  "RamUserId": "1234567890123456",
  "AccountId": "1234567890123456",
  "Arn": "acs:ram::1234567890123456:user/yyc3-admin"
}
```

### 3.2 验证RAM权限

**命令**：
```bash
aliyun ram ListPolicies
```

**预期输出**：
- 返回策略列表，包括 `yyc3-full-access`

### 3.3 验证用户组

**命令**：
```bash
aliyun ram ListGroupsForUser --UserName yyc3-admin
```

**预期输出**：
```json
{
  "Groups": [
    {
      "GroupId": "g-xxxxxxxxxxxxxxxx",
      "GroupName": "yyc3-admins",
      "Comments": "YYC³餐饮平台 - 管理员组",
      "CreateDate": "2026-01-03T00:00:00Z"
    }
  ]
}
```

---

## 四、常见问题

### Q1: 忘记了Root账户密码怎么办？

**A**：
1. 访问 https://account.aliyun.com/forgot_password
2. 输入账号邮箱或手机号
3. 按照提示重置密码

---

### Q2: AccessKey丢失了怎么办？

**A**：
1. 以管理员身份登录RAM控制台
2. 找到对应用户
3. 点击 "创建AccessKey"
4. 创建新的AccessKey
5. 删除旧的AccessKey（如有必要）

---

### Q3: 如何限制管理员权限？

**A**：
1. 创建自定义策略，只授予必要的权限
2. 使用最小权限原则（Least Privilege）
3. 定期审计RAM权限

---

## 五、输出与交付物

| 交付物 | 内容 |
|-------|------|
| 阿里云账号ID | `1234567890123456` |
| 账号显示名 | `YYC³餐饮平台` |
| RAM管理员账户 | `yyc3-admin` |
| RAM AccessKey ID | `LTAI...`（保存到密码管理工具） |
| RAM AccessKey Secret | `...`（保存到密码管理工具） |
| RAM用户组 | `yyc3-admins` |
| RAM策略 | `yyc3-full-access` |

---

## 六、参考文档

- [阿里云RAM文档](https://help.aliyun.com/product/28625.html)
- [阿里云CLI文档](https://help.aliyun.com/document_detail/121014.html)
- [阿里云Root账户最佳实践](https://help.aliyun.com/document_detail/100684.html)

---

**文档版本**: v1.0.0
**最后更新**: 2026-01-03
**维护人**: YYC³ Infrastructure Team
